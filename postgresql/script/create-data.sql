DROP TABLE IF EXISTS purchase;
DROP TABLE IF EXISTS referrer;
DROP TABLE IF EXISTS users;

CREATE TABLE purchase(
  ts              timestamp,
  order_id        integer,
  user_id         uuid,
  product_id      integer,
  purchase_amount integer
);
CREATE TABLE referrer(
  ts        timestamp,
  user_id   uuid,
  referrer  varchar(255)
);
CREATE TABLE users(
  user_id   uuid,
  sex       integer,
  birthday  date
);

INSERT INTO purchase
VALUES
  ('2014-01-01 00:00:00', 1, 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 1, 10000),
  ('2014-02-01 00:00:00', 2, 'BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 2, 20000),
  ('2014-03-01 00:00:00', 3, 'CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 3, 30000),
  ('2014-04-01 00:00:00', 4, 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 2, 20000),
  ('2014-05-01 00:00:00', 5, 'BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 3, 30000),
  ('2014-06-01 00:00:00', 6, 'CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 1, 10000),
  ('2014-07-01 00:00:00', 7, 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 3, 30000),
  ('2014-08-01 00:00:00', 8, 'BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 1, 10000),
  ('2014-09-01 00:00:00', 9, 'CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 2, 20000),
  ('2014-10-01 00:00:00', 10, 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 1, 10000)
;
INSERT INTO referrer
VALUES
  ('2014-01-01 00:00:00', 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 'https://www.example.com/campaign-a'),
  ('2014-02-01 00:00:00', 'BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 'https://www.example.com/campaign-b'),
  ('2014-03-01 00:00:00', 'CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 'https://www.example.com/campaign-c'),
  ('2014-10-01 00:00:00', 'AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 'https://www.example.com/campaign-a'),
  ('2014-11-01 00:00:00', 'BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 'https://www.example.com/campaign-b'),
  ('2014-12-01 00:00:00', 'CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 'https://www.example.com/campaign-c')
;
INSERT INTO users
VALUES
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAAA', 0, '2010-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBBB', 0, '2016-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCCC', 1, '2020-07-31'),
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAA1', 0, '1990-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBB1', 0, '1980-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCC1', 1, '1975-07-31'),
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAA2', 0, '2001-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBB2', 0, '1988-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCC2', 1, '1999-07-31'),
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAA3', 0, '2000-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBB3', 0, '1968-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCC3', 1, '1979-07-31'),
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAA4', 0, '1988-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBB4', 0, '1996-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCC4', 1, '1996-07-31'),
  ('AAAAAAAA-AAAA-AAAA-AAAA-AAAAAAAAAAA5', 0, '2009-01-01'),
  ('BBBBBBBB-BBBB-BBBB-BBBB-BBBBBBBBBBB5', 0, '1976-02-29'),
  ('CCCCCCCC-CCCC-CCCC-CCCC-CCCCCCCCCCC5', 1, '1988-07-31')
;